<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>ダウンロードのテスト2</title>
	<script type="text/javascript" src="jquery-1.11.3.min.js"></script>
	
	<script>
$(document).ready(function() {
	// Aタグのhref属性に、Blobを設定する。
	// Blobに含めるデータは、引数で指定する。
    function setBlobUrl(id, content) {
        // IE 10.0以降、Firefox 13.0以降、Chrome 20.0以降、Safari 6.0以降
		console.log("window.Blob=" + window.Blob);
        
        // IE 10.0以降、Firefox 12.0以降
        console.log("window.URL=" + window.URL);
        // Chrome 20.0以降, Safari 6.0以降
        console.log("window.webkitURL=" + window.webkitURL);
        
    	// 指定されたデータを保持するBlobを作成する。
        var blob = new Blob([ content ], { "type" : "text/plain" });

		// Aタグのhref属性にBlobオブジェクトを設定する。
        window.URL = window.URL || window.webkitURL;
        $("#" + id).attr("href", window.URL.createObjectURL(blob));
	}

	$("#content").keydown(function(){
		alert('1');
		setBlobUrl("download", "x");//$("#content").val());
		alert('x');
	});
    
    $("#content").keyup();
});
	</script>
</head>

<body>
	任意のファイルをJavaScriptでダウンロードさせるテスト<br />
	<hr />
	<textarea id="content" cols="40" rows="5">Hello, World!
こんにちは、みなさん！</textarea><br />
	<a id="download" target="_blank">ダウンロード</a>
</body>

</html>
